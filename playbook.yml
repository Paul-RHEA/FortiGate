---

- name: Configure Ansible controller for this specific scenario
  hosts: localhost
  become: yes
  become_user: root
  #The vault file stores the passwords in an encrypted format
  vars_files:
    /etc/ansible/host_vars/vault_vars.yml
  vars:
    ansible_become_pass: '{{ become_p }}'
  roles:
    # The scenarioInit role set-up the iventory with the hosts defined in the Scenario template generated by CITEF
    - scenarioInit

- name: Print hosts information
  hosts: all
  tasks:
    - name: List hosts
      debug:
        msg: '{{ inventory_hostname }}'
    - name: List groups
      debug:
        msg: '{{ group_names }}'

- name: Example of a basic task
  #Hostname is auto-generated from the 'name' field registered in the Configuration of the Asset in CITEF
  hosts: UBUNTU_LAMP
  gather_facts: no
  become: yes
  become_user: root
  vars_files:
      - /etc/ansible/host_vars/vault_vars.yml
  vars:
    ansible_become_pass: '{{ become_p }}'

  tasks:
    - name: Wait host to come up
      wait_for_connection:
        timeout:  36000 # 10 hours
        sleep: 5

    - name: Gather facts
      setup:

    - name: Display all the facts gather by Ansible on the Host
      debug:
        msg: '{{ ansible_facts }}'
